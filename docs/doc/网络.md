# 网络相关面试题

### 网络的七层协议



### TCP协议的3次握手和4次挥手

- 三次握手
- 四次挥手

### TCP为什么要采用3次握手而不用2次

一致性问题：2次握手证明client到server是可达的，但是无法证明server到client是可达的。举例来说：如果client第一次发送SYN包由于网络抖动没有及时到达，所以client会再次发送SYN包。一段时间后，第一次抖动的SYN包最后又到达了server，所以如果server用最后拿到的SYN直接ACK回复client的话。client认为只有一个连接，server认为有两个连接。最终造成状态不一致。

### 如何防止TCP的Dos攻击

- TCP的连接资源全部基于内网连接
- 在收到SYN包的不急于分配TCB资源，而是先回复一个ACK报文，并在一个专门的Hash表中保存这个连接，直到收到正确的ACK才给分配TCB资源
- 建立cookies机制：就是对于已经建立连接的TCP继续分配资源，对于大量发出SYN报文但是不回复ACK报文的，不予受理。cookies的建立是利用了hash算法提取TCP头部的一写字段来做标记，相当于建立了一个白名单。

### 一台服务器支持多少TCP连接

